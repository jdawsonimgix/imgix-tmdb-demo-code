{"version":3,"sources":["../../src/HOFs/propFormatter.js"],"names":["formatSrc","src","domain","useHTTPS","indexOf","strippedDomain","replace","strippedSrc","prefix","formatProps","props","width","undefined","height","useHttps","collapseImgixParams","params","compactedParams","k","v","PARAMS_EXP_MAP","processPropsHOF","Component","formattedProps","formattedImgixParams","imgixParams"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { PARAMS_EXP_MAP } from \"./constants\"\n\n/**\n * Creates a 1-step, or complete, URL from `domain` and `src` Strings.\n *\n * - First, the function checks if src has a defined `domain`. If it does, it \n * checks to see if `src` has a scheme, and prepends \"http\" or \"https\" as needed\n * - Otherwise, formatSrc formats `domain` and `src` Strings.\n *   - First it strips the two strings of the  leading and `/` or trailing `/` \n *     slash characters.\n *   - Then, it joins the two strings on a `/` character. IE, \n *    `strippedDomain + \"/\" + strippedSrc`.\n *   - If `domain` String argument `null` or `undefined`, the function returns\n *    the original `src` String.\n *\n * @param {String} src - URL that is either 1-step or 2-step\n * @param {String} domain - Domain string, optional\n * @returns 1-step, or complete, URL String. Ex, _assets.ix.net/foo/bar.jpg_\n */\nexport function formatSrc(src, domain, useHTTPS = true) {\n  // ignore if already has protocol\n  if (src.indexOf(\"://\") !== -1){\n    return src\n  } else {\n    // prepend domain if defined\n    if (domain == null) {\n      return src\n    }\n    const strippedDomain = domain ? domain.replace(/^\\/|\\/$/g, '') : \"\"\n    const strippedSrc = src.replace(/^\\/|\\/$/g, '')\n    const prefix = useHTTPS ? \"https://\" : \"http://\"\n    return prefix + strippedDomain + \"/\" + strippedSrc;\n  }\n}\n\n/**\n * A function that formats the following values in the props Object:\n *\n * - `width`: if undefined or negative gets set to `undefined`.\n * - `height`: if undefined or negative gets set to `undefined`.\n * - `src`: concatenated to `domain` if `src` defined and has no domain.\n *\n * @param {Object} props \n * @returns A formatted `props` Object.\n */\nexport const formatProps = (props) => {\n  const width = !props.width || props.width <= 1 ? undefined : props.width\n  const height = !props.height || props.height <= 1 ? undefined : props.height\n  const src = props.src ? formatSrc(props.src, props.domain, props.useHttps) : undefined\n\n  return Object.assign( {}, props, { width, height, src,} )\n}\n\n/**\n * Function that shortens params keys according to the imgix spec.\n * @param {Object} params - imgixParams object\n * @returns imgixParams object with shortened keys\n * @see https://www.imgix.com/docs/reference\n */\nexport const collapseImgixParams = (params) => {\n  if (params == null) {\n    return params;\n  }\n  const compactedParams = {}\n  for (const [k, v] of Object.entries(params)) {\n    if (PARAMS_EXP_MAP[k]) {\n      compactedParams[PARAMS_EXP_MAP[k]] = v\n    } else {\n      compactedParams[k] = v\n    }\n  }\n  return compactedParams\n}\n\n/**\n * `processPropsHOF` takes a Component's props and formats them to adhere to the \n * ImgixClient's specifications.\n * \n * @param {React.Element<typeof Component>} Component - A react component with\n * defined `props`.\n * @returns A React Component who's `props` have been formatted and \n * `imgixParams` have been collapsed.\n */\nexport const processPropsHOF = (Component) => (props) => {\n  const formattedProps = formatProps(props)\n  const formattedImgixParams = collapseImgixParams(formattedProps.imgixParams)\n\n  return <Component {...formattedProps} imgixParams={formattedImgixParams} />\n}\n"],"file":"propFormatter.js"}